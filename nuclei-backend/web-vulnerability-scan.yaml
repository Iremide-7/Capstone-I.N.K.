id: web-vulnerability-scan

info:
  name: Web App Security Scan
  author: iremide
  severity: high
  description: "Scans for common web vulnerabilities (SQL Injection, XSS, Exposed Admin Panels)"
  tags: sql, xss, exposure, admin, web

variables:
  xss_payload: "<script>alert('XSS')</script>"

requests:
  - method: GET
    path:
      - "{{BaseURL}}/search.php?q=' OR '1'='1' -- "
      - "{{BaseURL}}/login.php?username=admin' -- &password="
    matchers:
      - type: word
        words:
          - "You have an error in your SQL syntax"
          - "Warning: mysql_fetch_array()"
          - "unclosed quotation mark after the character string"
        condition: or

  - method: GET
    path:
      - "{{BaseURL}}/test.php?input={{xss_payload}}"
    matchers:
      - type: word
        words:
          - "<script>alert('XSS')</script>"
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/admin/"
      - "{{BaseURL}}/admin/login"
    matchers:
      - type: status
        status:
          - 200
